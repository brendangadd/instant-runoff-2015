"use strict";function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function logDistribution(t,r){var n={BLANK:0},e=!0,a=!1,i=void 0;try{for(var o,s=Object.keys(NEXT_RANK_DISTRIBUTION)[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){var l=o.value;n[l]=0}}catch(u){a=!0,i=u}finally{try{!e&&s["return"]&&s["return"]()}finally{if(a)throw i}}var h=!0,f=!1,y=void 0;try{for(var c,v=t[Symbol.iterator]();!(h=(c=v.next()).done);h=!0){var d=c.value,l=d.ranking[r]||"BLANK";n[l]++}}catch(u){f=!0,y=u}finally{try{!h&&v["return"]&&v["return"]()}finally{if(f)throw y}}var g=Object.keys(n).reduce(function(t,r){return t+n[r]},0),m=!0,k=!1,b=void 0;try{for(var w,p=Object.keys(n)[Symbol.iterator]();!(m=(w=p.next()).done);m=!0){var x=w.value;n[x]/=g}}catch(u){k=!0,b=u}finally{try{!m&&p["return"]&&p["return"]()}finally{if(k)throw b}}console.log(n)}function generateVotes(t,r){for(var n=[],e=0;t>e;e++)n.push(new Vote);for(;generateRanks(n,r););return n}function generateRanks(t,r){var n=!1,e=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){var l=o.value;if(!l.isClosed){var u=l.ranking.length,h=u>0?l.ranking[u-1]:"BLANK",f=r[h],y=Math.random(),c=0,v=!0,d=!1,g=void 0;try{for(var m,k=f[Symbol.iterator]();!(v=(m=k.next()).done);v=!0){var b=m.value;if(c+=b.probability,c>y){l.hasRankFor(b.party)||(l.addRankFor(b.party),n=!0);break}}}catch(w){d=!0,g=w}finally{try{!v&&k["return"]&&k["return"]()}finally{if(d)throw g}}l.ranking.length===u&&l.close()}}}catch(w){a=!0,i=w}finally{try{!e&&s["return"]&&s["return"]()}finally{if(a)throw i}}return n}var _createClass=function(){function t(t,r){for(var n=0;n<r.length;n++){var e=r[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(r,n,e){return n&&t(r.prototype,n),e&&t(r,e),r}}(),Vote=function(){function t(){_classCallCheck(this,t),this.ranking=[],this.isClosed=!1}return _createClass(t,[{key:"hasRankFor",value:function(t){return this.ranking.indexOf(t)>=0}},{key:"addRankFor",value:function(t){if(this.hasRankFor(t))throw new Error("Vote already has a rank for "+t+".");if(this.isClosed)throw new Error("Ranks cannot be added to a closed vote.");return this.ranking.push(t),this}},{key:"close",value:function(){return this.isClosed=!0,this}}]),t}(),InstantRunoffElection=function(){function t(r){_classCallCheck(this,t),this.votes=r,this.assignment={},this.exhaustedVotes=[];var n=!0,e=!1,a=void 0;try{for(var i,o=r[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;if(0===s.ranking.length)this.exhaustedVotes.push(s);else{var l=s.ranking[0];this.assignment.hasOwnProperty(l)||(this.assignment[l]=[]),this.assignment[l].push(s)}}}catch(u){e=!0,a=u}finally{try{!n&&o["return"]&&o["return"]()}finally{if(e)throw a}}}return _createClass(t,[{key:"leader",value:function(){var t={numVotes:0},r=!0,n=!1,e=void 0;try{for(var a,i=Object.keys(this.assignment)[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var o=a.value,s=this.assignment[o].length;s>t.numVotes&&(t={name:o,numVotes:s})}}catch(l){n=!0,e=l}finally{try{!r&&i["return"]&&i["return"]()}finally{if(n)throw e}}return t.name}},{key:"trailer",value:function(){var t={numVotes:Number.MAX_SAFE_INTEGER},r=!0,n=!1,e=void 0;try{for(var a,i=Object.keys(this.assignment)[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var o=a.value,s=this.assignment[o].length;s<t.numVotes&&(t={name:o,numVotes:s})}}catch(l){n=!0,e=l}finally{try{!r&&i["return"]&&i["return"]()}finally{if(n)throw e}}return t.name}},{key:"hasWinner",value:function(){return this.assignment[this.leader()].length>this.votes.length/2||this.assignment.length<=2}},{key:"advanceRound",value:function(){if(!this.hasWinner()){var t=this.trailer(),r=this.assignment[t];delete this.assignment[t];var n=!0,e=!1,a=void 0;try{for(var i,o=r[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value,l=!1,u=!0,h=!1,f=void 0;try{for(var y,c=s.ranking[Symbol.iterator]();!(u=(y=c.next()).done);u=!0){var v=y.value;if(this.assignment.hasOwnProperty(v)){this.assignment[v].push(s),l=!0;break}}}catch(d){h=!0,f=d}finally{try{!u&&c["return"]&&c["return"]()}finally{if(h)throw f}}l||this.exhaustedVotes.push(s)}}catch(d){e=!0,a=d}finally{try{!n&&o["return"]&&o["return"]()}finally{if(e)throw a}}}}}]),t}();
//# sourceMappingURL=instant-runoff.js.map
